{% load staticfiles %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="personal blog about technology, politics, religion, sports, nutrition, etc.">
        <link rel="shortcut icon" href="{% static 'blog/images/favicon.png' %}" type="image/x-icon">
        <title>{% block title %}{% endblock %}</title>
        <link href="{% static 'blog/css/bootstrap.min.css' %}" rel="stylesheet" type="text/css" />
        <link href="{% static 'blog/css/jquery-ui-1.10.4.custom.min.css' %}" rel="stylesheet" type="text/css" />
        <link href="{% static 'blog/css/app.css' %}" rel="stylesheet" type="text/css">
        <link href="{% static 'blog/css/pygments.css' %}" rel="stylesheet" type="text/css">
        <link href="{% static 'blog/css/select2.css' %}" rel="stylesheet" type="text/css">
        {% block extra_js_in_header %}{% endblock %}
    </head>
    <body>
        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="{% url 'home' %}">
                        <img style="margin-top: -15px;" width="152" height="34" src="{% static 'blog/images/logo.png' %}" />
                    </a>
                </div>
                <div class="navbar-collapse collapse" role="navigation">
                    <ul class="nav navbar-nav">
                        <li class="{{ home_tab }}"><a href="{% url 'home' %}"><span class="glyphicon glyphicon-home"></span> Home</a></li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Posts By Category<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a class="{{ prs_list_tab }}" href="#"> General  </a></li>
                                <li><a class="{{ prs_monthly_tab }}" href="#"> Technical  </a></li>
                                <li><a class="{{import_pr_list_tab }}" href="#">  Health  </a></li>
                            </ul>
                        </li>
                    </ul>
                    {% if user.is_authenticated  %}
                    <ul class="nav navbar-nav navbar-right">
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <span class="glyphicon glyphicon-user"></span> {{ user.username }}
                                <b class="caret"></b>
                            </a>
                            <ul class="dropdown-menu">
                                <li class="dropdown-header">Profile</li>
                                <li><a href="{%  url 'newblogpost' %}"> New BlogPost </a></li>
                                <li><a href="{% url 'logout' %}"> Logout </a></li>
                            </ul>
                        </li><!-- .dropdown collapse -->
                    </ul>
                    {% endif %}
                    <form class="navbar-form" role="form" method="GET" action="/search/">
                        <div class="input-group">
                            <input type="search" name="q" value="{{ query }}" placeholder="Search" class="form-control" />
                            <span class="input-group-btn">
                                <button class="btn btn-primary" type="submit" id="filter-clear">
                                    <i class="glyphicon glyphicon-search"></i>
                                </button>
                            </span>
                        </div>
                    </form>
                </div><!-- .navbar-header collapse -->
            </div><!-- .container collapse -->
        </div><!-- .navbar collapse -->

        
        <div class="container-fluid">
            <div class="row">
                <div class = "col-sm-10" style="border-right:0.5px solid #ccc">
                    <div id = "messages">
                        {% if messages %}
                            {% for message in messages %}
                                    {% if 'safe' in message.tags %}
                                        <div class="alert alert-{{message.level_tag}} alert-dismissible" role="alert">
                                        <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                        {{ message|safe }}</div>
                                    {% else %} 
                                        <div class="alert alert-{{message.level_tag}} alert-dismissible" role="alert">
                                        <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                        {{ message }}</div>
                                    {% endif %}
                            {% endfor %}
                        {% endif %}
                    </div><!-- .messages div collapse -->

                    <div class="page-header" align = "center">
                        <h4>
                            {% block page_title %} {% endblock %} 
                            <small><p>{% block description %} {% endblock %}</p></small>
                        </h4>
                    </div>
                    <div>
                        {% block content %} {% endblock %}
                    </div>
                </div> <!-- col-xs-9 div collapse -->

                <!-- RIGHT SIDEBAR -->
                <div class = "col-sm-2" style="border-left:0.5px solid #ccc">
                    <div class="panel panel-primary">
                        <div class="panel-heading">Archive</div>
                        <div class="panel-body">
                        <ul class="nav nav-list">
                            {% for year, months in archive_data.items %}
                                {% if year %}
                                <li>
                                    <label class="tree-toggler nav-header">
                                        <span class="glyphicon glyphicon-chevron-down"></span> 
                                         <a href="{% url 'yearly' year %}"> <span class="badge"> {{ year }}</span> </a>
                                    </label>
                                    <ul class = "tree">
                                        {% for month in months %}
                                            <li class="list-group-item"> 
                                                <a href="{% url 'monthly' year month.0 %}"> {{month.0}}</a> 
                                                <span class="badge pull-right"> {{month.1}} </span>
                                            </li>
                                        {% endfor %}
                                    </ul>
                                </li>
                                {% endif %}
                            {% endfor %}
                        </ul>
                        </div>
                    </div>
                    <div id="tag_cloud" class="panel panel-primary">
                        <div class="panel-heading">Tags In-Use</div>
                        <div class="panel-body">
                            {% for t in tagcloud %}
                                <a href="/search/?q={{ t.name }}" style="font-size: {{ t.fontsize }}em" title="Number of articles using this tag: {{ t.frequency }}"> {{ t.name }}</a>
                            {% endfor %}
                        </div>
                    </div>
 
                    <div class="list-group">
                        <a href="#" class="list-group-item active">Categories</a>
                        {% for c in categories %}
                            <a href="/search/?q={{ c.name }}" class="list-group-item"> 
                                {{ c.name }}<span class="badge pull-right"> {{c.frequency}} </span></a>
                        {% endfor %}
                    </div>

                </div> <!--  col-md-3 div collapse END RIGHT SIDEBAR-->
            </div> <!-- div row collapse -->
        </div><!-- .container div collapse -->

        <!--http://getbootstrap.com/examples/sticky-footer-navbar/-->
        <div id="footer"><!-- Sticky Footer -->
            <div class="container-fluid">
                <span style="float: left;" class="text-muted">
                    Mahmood Khan's blog @  KHANKORE {% now "Y" %}
                </span>
                <span style="float:right;" class="text-muted">
                    <a href="{% url 'about' %}" class="text-muted">About</a> | 
                    <a href="{% url 'contact' %}" class="text-muted">Contact</a>
                </span>
            </div>
        </div><!-- .footer div collapse -->

        <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script type="text/javascript" src="{% static 'blog/js/jquery-1.11.0.min.js' %}"></script>

        <script type="text/javascript" src="{% static 'blog/js/select2.min.js' %}"></script>

        <!-- Bootstrap compiled javascript plugins -->
        <script type="text/javascript" src="{% static 'blog/js/bootstrap.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'blog/js/app.js' %}"></script>
        <script type="text/javascript">
            $(document).ready(function () {
                $('label.tree-toggler').click(function () {
                    $(this).parent().children('ul.tree').toggle(100);
                    $(this).children('span').toggleClass( "glyphicon glyphicon-chevron-down glyphicon glyphicon-chevron-right");
                });
            });
        </script>
    </body>
</html>
